<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Portal ‚Äî LearnBridge University Management</title>
  <link rel="icon" type="image/png" href="assets/logos/uj.png" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
  
  <style>
    /* * LearnBridge Admin Portal Styles
     * Theme: Dark/Orange Accent (UJ Inspired)
     * Accent Color: #ff7a00 (LearnBridge Orange)
     */
    
    /* Global Reset & Typography */
    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0; 
      font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; /* Consistent font stack */
    }
    
    body {
      background: linear-gradient(135deg, #000 0%, #333 100%); /* Darker Admin BG */
      display: flex;
      min-height: 100vh;
      color: #333; /* Default text color for main content */
    }
    
    /* --- Layout Structure --- */
    .portal-wrapper { 
      display: flex; 
      width: 100%; 
      min-height: 100vh; 
    }
    
    /* Sidebar */
    .portal-sidebar {
      width: 250px;
      min-width: 200px; /* Min-width for better responsiveness */
      background: rgba(0,0,0,0.9); /* Slightly more opaque */
      backdrop-filter: blur(10px);
      color: white;
      padding: 20px 15px; /* Adjusted padding */
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      box-shadow: 4px 0 20px rgba(0,0,0,0.7);
      z-index: 10; /* Ensure it stays above content */
    }
    
    .portal-sidebar img { 
      width: 70px; 
      margin-bottom: 10px; 
    }
    
    .sidebar-header { 
      text-align: center; 
      color: #ff7a00; 
      font-size: 22px; 
      font-weight: 800; /* Bolder for impact */
      margin-bottom: 20px;
    }
    
    /* Sidebar Menu */
    .sidebar-menu ul { 
      list-style: none; 
      padding: 0; 
    }
    
    .sidebar-menu li {
      padding: 12px;
      background: rgba(255,255,255,0.05);
      border-radius: 8px; /* Slightly rounder corners */
      margin-bottom: 8px;
      cursor: pointer;
      transition: background 0.18s, color 0.18s;
      display:flex; 
      justify-content:space-between; 
      align-items:center;
      font-weight: 500;
    }
    
    .sidebar-menu li.active, .sidebar-menu li:hover { 
      background: #ff7a00; /* Use primary accent */
      color: #fff; 
      box-shadow: 0 0 10px rgba(255, 122, 0, 0.5); /* Subtle glow on hover/active */
    }
    
    .sidebar-footer { 
      font-size: 11px; 
      color: #ff7a00; 
      opacity: 0.9; 
      text-align: center; 
      padding-top: 15px;
      border-top: 1px solid rgba(255,255,255,0.1);
    }
    
    /* Main Content Area */
    .portal-main { 
      flex-grow: 1; 
      background: #f4f4f4; /* Lighter main BG for contrast */
      padding: 30px; 
      overflow-y: auto; 
    } 
    
    /* Main Header */
    .main-header { 
      display: flex; 
      justify-content: space-between; 
      align-items: center; 
      margin-bottom: 25px; 
      background: white; 
      padding: 18px 25px; /* Increased padding */
      border-radius: 12px; 
      box-shadow: 0 4px 15px rgba(0,0,0,0.08); /* Stronger shadow */
    }
    
    .main-header h1 { 
      color: #cc6600; 
      font-size: 28px; 
      font-weight: 700;
    } 
    
    .user-info { 
      font-size: 15px; 
      font-weight: 600; 
      color: #444; 
    }
    
    h2 { 
      color: #ff7a00; 
      margin-bottom: 15px; /* Increased margin */
      border-bottom: 2px solid #ff7a00; 
      padding-bottom: 5px; 
      font-size: 24px;
      font-weight: 700;
    }
    
    h3 {
      color: #555;
      margin-bottom: 15px;
      font-size: 20px;
    }

    /* --- Dashboard Elements --- */
    .admin-cards { 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); 
      gap: 20px; /* Increased gap */
      margin-bottom: 30px; 
    }
    
    .admin-card { 
      padding: 25px; /* Increased padding */
      background: white; 
      border-radius: 12px; 
      box-shadow: 0 4px 20px rgba(0,0,0,0.15); /* Stronger shadow */
      border-left: 6px solid #ff7a00; /* Thicker border */
      transition: all 0.2s ease-in-out;
    }
    
    .admin-card:hover { 
      transform: translateY(-5px); /* More pronounced lift */
      box-shadow: 0 10px 30px rgba(0,0,0,0.2); 
    }
    
    .admin-card h4 { 
      font-size: 15px; 
      color: #666; 
      margin-bottom: 8px; 
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .admin-card .metric { 
      font-size: 32px; /* Larger metric */
      font-weight: 900; 
      color: #111; 
    }

    .chart-container { 
      height: 300px; 
      background: #fff; 
      padding: 20px; 
      border-radius: 12px; 
      box-shadow: 0 2px 10px rgba(0,0,0,0.05); 
    }
    .muted { color: #888; font-size: 14px; }

    /* --- Form Elements & Buttons --- */
    input, select, textarea { 
      width: 100%; 
      padding: 12px; 
      border-radius: 8px; /* Consistent radius */
      border: 1px solid #ddd; 
      margin-bottom: 15px; 
      transition: border-color 0.15s;
    }
    input:focus, select:focus, textarea:focus {
        border-color: #ff7a00;
        outline: none;
    }
    
    button.btn { 
      background: #ff7a00; 
      color: white; 
      padding: 12px 18px; /* Increased padding */
      border: none; 
      border-radius: 8px; 
      cursor: pointer; 
      font-weight: 700; 
      transition: 0.2s; 
    }
    
    button.btn:hover { 
      background: #cc6600; 
      transform: translateY(-1px);
    }
    
    button.btn.secondary { 
      background: #eee; 
      color: #555; 
    }
    button.btn.secondary:hover { 
        background: #ccc;
        color: #333;
    }
    
    button.btn.danger { 
      background: #d73a3a; 
      color: white; 
    }
    button.btn.danger:hover { background: #b02e2e; }

    button.btn.btn-sm { padding: 6px 10px; font-size: 12px; }

    .hidden { display: none !important; }

    .search-row { 
      display:flex; 
      gap:15px; /* Increased gap */
      margin-bottom:20px; 
      align-items:center; 
      padding: 15px; 
      background: #fff; 
      border-radius: 10px; 
      box-shadow: 0 1px 8px rgba(0,0,0,0.05); 
    }
    
    /* --- Table Styling --- */
    table { 
      width:100%; 
      border-collapse: collapse; 
      background: white; 
      border-radius: 12px; 
      overflow: hidden; 
      box-shadow: 0 4px 15px rgba(0,0,0,0.05); 
    }
    
    th, td { 
      padding:15px; 
      border-bottom: 1px solid #f0f0f0; 
      text-align:left; 
      vertical-align: middle;
      font-size: 14px;
    }
    
    th { 
      background: #e9e9e9; /* Lighter header BG */
      color: #333; 
      font-weight: 700; 
      text-transform: uppercase;
    }
    
    tr:hover { 
      background: #fff5ee; /* Very light orange on hover */
    }
    
    .empty { 
      text-align:center; 
      padding:30px; 
      border:2px dashed #ccc; 
      border-radius:10px; 
      color:#666; 
      margin-top: 20px; 
      background: #fff;
    }

    /* --- General Layouts & Components --- */
    .section-content { 
      background: white; 
      padding: 30px; /* Increased padding */
      border-radius: 12px; 
      box-shadow: 0 2px 15px rgba(0,0,0,0.05); 
      margin-bottom: 30px; 
    }
    
    .card-grid { 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); /* Slightly wider min card */
      gap: 20px; 
    }
    
    .session-card, .request-card { 
      padding: 20px; 
      border-radius: 10px; 
      box-shadow: 0 3px 15px rgba(0,0,0,0.08); 
      background: #fff; 
      border-left: 5px solid; /* Thicker border */
    }
    
    .session-card.pending { border-left-color: #ff7a00; }
    .session-card.approved { border-left-color: #007bff; }
    .session-card.completed { border-left-color: #28a745; }
    
    .request-card h4, .session-card h4 { 
      color: #ff7a00; 
      margin-bottom: 10px; 
      font-size: 18px;
    }

    /* Tags */
    .tag { 
      padding: 4px 10px; 
      border-radius: 6px; 
      font-size: 12px; 
      font-weight: bold; 
      margin-right: 5px; 
      display: inline-block;
      text-transform: uppercase;
    }
    
    .tag.pending { background: #ffc107; color: #333; }
    .tag.approved { background: #28a745; color: white; }
    .tag.suspended { background: #d73a3a; color: white; }
    .tag.live { background: #007bff; color: white; }
    .tag.normal { background: #17a2b8; color: white; }
    .tag.urgent { background: #d73a3a; color: white; }

    /* Media Queries for Responsiveness */
    @media(max-width: 1024px) {
        .admin-cards { grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); }
    }
    
    @media(max-width: 800px){ 
      .portal-sidebar { width: 200px; padding: 15px; } 
      .main-header { flex-direction: column; align-items: flex-start; }
      .main-header h1 { margin-bottom: 10px; }
      .search-row { flex-wrap: wrap; }
      .search-row input, .search-row select { flex: 1 1 45%; }
    }
    @media(max-width: 600px){
        .portal-wrapper { flex-direction: column; }
        .portal-sidebar { width: 100%; height: auto; padding-bottom: 0; }
        .sidebar-menu ul { display: flex; flex-wrap: wrap; justify-content: center; margin-top: 10px; }
        .sidebar-menu li { margin: 5px; flex-grow: 1; text-align: center; }
        .portal-main { padding: 15px; }
        .admin-cards { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>
<div class="portal-wrapper">

  <aside class="portal-sidebar">
    <div>
      <div class="sidebar-header">
        <img src="assets/logos/uj.png" alt="University of Johannesburg Logo">
        <div>AdminBridge</div>
      </div>

      <nav class="sidebar-menu" aria-label="Main Navigation">
        <ul>
          <li id="menuDashboard" class="active" title="System Dashboard">üìä Dashboard</li>
          <li id="menuManageUsers" title="Manage Students, Tutors, and Counsellors">üë• Manage Users</li>
          <li id="menuSessionManagement" title="View and Manage All Bookings">üìÖ Session Management</li>
          <li id="menuBookingRequests" title="Approve or Reject New Booking Requests">üì• Booking Requests <span id="pendingRequestsBadge" class="tag pending" style="display:none;margin-left:8px;padding:3px 7px;">0</span></li>
          <li id="menuIssuesReports" title="View and Resolve Reported Issues">üö® Issues & Reports</li>
          <li id="menuRatingsAnalytics" title="Review Performance and Ratings">‚≠ê Ratings & Performance</li>
          <li id="menuUniversitySettings" title="Configure Departments, Modules, and Policies">‚öôÔ∏è University Settings</li>
          <li id="menuNotificationsControl" title="Send Announcements and Manage Notification Categories">üîî Notifications Control</li>
          <li id="menuReportsAudit" title="Generate Data Reports and View Audit Logs">üìú Reports & Audit</li>
          <li id="menuAdminProfile" title="Manage Admin Account and Security">üë§ Admin Profile</li>
        </ul>
      </nav>
            <nav class="sidebar-menu" style="margin-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
          <ul>
              <li id="menuLogout" style="background: #d73a3a; color: white;" title="Log out of the system">
                  üö™ Log Out
              </li>
          </ul>
            </nav>
    </div>

    <div class="sidebar-footer">
      System Administrator ‚Ä¢ LearnBridge<br>
      <small class="muted">Access Level: Full</small>
    </div>
  </aside>

  <main class="portal-main">
    <header class="main-header">
      <h1>Admin Portal</h1>
      <div class="user-info">
        Admin: Jane Doe ‚Ä¢ <span id="currentTime"></span>
      </div>
    </header>

    <section id="dashboardSection">
      <h2>üìä System Dashboard: Real-Time Analytics</h2>

      <div class="admin-cards">
        <div class="admin-card">
          <h4>Total Students</h4>
          <div class="metric" id="totalStudents">0</div>
        </div>
        <div class="admin-card">
          <h4>Total Tutors/Counsellors</h4>
          <div class="metric" id="totalStaff">0</div>
        </div>
        <div class="admin-card">
          <h4>New Sign-Ups (Today)</h4>
          <div class="metric" id="newSignupsToday">0</div>
        </div>
        <div class="admin-card" style="border-left-color: #ffc107;">
          <h4>Pending Tutor Approvals</h4>
          <div class="metric" id="pendingApprovals">0</div>
        </div>
        <div class="admin-card" style="border-left-color: #ff7a00;">
          <h4>Pending Bookings</h4>
          <div class="metric" id="pendingBookings">0</div>
        </div>
        <div class="admin-card" style="border-left-color: #28a745;">
          <h4>Sessions Today</h4>
          <div class="metric" id="sessionsToday">0</div>
        </div>
        <div class="admin-card" style="border-left-color: #007bff;">
          <h4>Live Sessions (In Progress)</h4>
          <div class="metric" id="liveSessions">0</div>
        </div>
        <div class="admin-card" style="border-left-color: #d73a3a;">
          <h4>Issues Reported Today</h4>
          <div class="metric" id="issuesToday">0</div>
        </div>
        <div class="admin-card">
          <h4>Average Tutor Rating</h4>
          <div class="metric" id="avgRating">N/A</div>
        </div>
      </div>
      
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px;">
        <div class="chart-container">
          <h4>Weekly Sessions Trend (Line Chart)</h4>
          <p class="muted">Chart placeholder for weekly session volume (e.g., using Chart.js).</p>
        </div>
        <div class="chart-container">
          <h4>Session Mode Comparison (Pie Chart)</h4>
          <p class="muted">Chart placeholder for Online vs. In-person usage distribution.</p>
        </div>
      </div>

      <div class="section-content">
        <h3>‚ö° Quick Actions</h3>
        <div style="display:flex; flex-wrap:wrap; gap:10px;">
          <button class="btn" id="quickApproveTutors">Approve Tutors (<span data-metric-ref="pendingApprovals">0</span>)</button>
          <button class="btn" id="quickViewIssues">View All Issues (<span data-metric-ref="issuesToday">0</span>)</button>
          <button class="btn" id="quickManageModules">Manage Modules/Departments</button>
          <button class="btn secondary" id="quickSendAnnouncement">Send Announcement</button>
          <button class="btn secondary" id="quickOpenSettings">Manage University Settings</button>
          <button class="btn secondary" id="quickAnalyticsPanel">Open Analytics Panel</button>
        </div>
      </div>

    </section>

    <section id="manageUsersSection" class="hidden">
      <h2>üë• Manage Users (Students / Tutors / Counsellors)</h2>

      <div class="search-row">
        <input id="userSearchInput" type="search" placeholder="Search by name, email, UJ ID..." style="flex:2">
        <select id="userFilterRole" style="flex:1">
          <option value="">All Roles</option>
          <option value="student">Student</option>
          <option value="tutor">Tutor</option>
          <option value="counsellor">Counsellor</option>
          <option value="admin">Admin</option>
        </select>
        <select id="userFilterStatus" style="flex:1">
            <option value="">All Statuses</option>
            <option value="active">Active</option>
            <option value="pending">Pending</option>
            <option value="suspended">Suspended</option>
        </select>
        <button class="btn" id="userSearchBtn">Search</button>
        <button class="btn secondary" id="userExportBtn">Export CSV</button>
      </div>

      <div class="section-content">
        <div style="display:flex; flex-wrap:wrap; gap:10px; margin-bottom:15px;">
          <button class="btn secondary" id="bulkApproveBtn">Bulk Approve Tutors (0 selected)</button>
          <button class="btn danger" id="bulkSuspendBtn">Bulk Suspend Users (0 selected)</button>
        </div>
        
        <table>
          <thead>
            <tr>
              <th><input type="checkbox" id="selectAllUsers"></th>
              <th>Name</th>
              <th>Role</th>
              <th>Email</th>
              <th>Status</th>
              <th>Last Login</th>
              <th>Total Sessions</th>
              <th>Rating</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="userTableBody">
            </tbody>
        </table>
        <div id="userEmpty" class="empty">No users matching your criteria.</div>
      </div>
    </section>

    <section id="sessionManagementSection" class="hidden">
      <h2>üìÖ Session Management (All Bookings)</h2>

      <div class="search-row">
        <input id="sessionSearchInput" type="search" placeholder="Search by tutor/student name, module..." style="flex:1">
        <select id="sessionFilterStatus">
          <option value="">All Statuses</option>
          <option value="approved">Approved</option>
          <option value="pending">Pending</option>
          <option value="in-progress">In-Progress</option>
          <option value="completed">Completed</option>
          <option value="canceled">Canceled</option>
        </select>
        <select id="sessionFilterDate">
          <option value="upcoming">Upcoming</option>
          <option value="past">Past</option>
          <option value="all">All Dates</option>
        </select>
        <button class="btn" id="sessionSearchBtn">Search</button>
      </div>
      
      <div style="margin-bottom: 30px;">
        <h3>Calendar View</h3>
        <div class="chart-container" style="height: 400px; padding: 10px;">
          <p class="muted">Full weekly/monthly calendar placeholder (e.g., using FullCalendar.io). Blue=Approved, Green=Today, Orange=Pending, Red=Canceled.</p>
        </div>
      </div>

      <h3>Upcoming Sessions List</h3>
      <div id="sessionList" class="card-grid">
        </div>
      <div id="sessionEmpty" class="empty">No sessions found.</div>
    </section>
    
    <section id="bookingRequestsSection" class="hidden">
      <h2>üì• Booking Requests (Approval Center)</h2>
      
      <div id="pendingRequestsList" class="card-grid">
        </div>
      <div id="requestsEmpty" class="empty">No pending booking requests.</div>
    </section>
    
    <section id="issuesReportsSection" class="hidden">
      <h2>üö® Issues & Reports Center (Ticket System)</h2>

      <div class="search-row">
        <input id="issueSearchInput" type="search" placeholder="Search by title, reporter, or ID..." style="flex:1">
        <select id="issueFilterPriority">
          <option value="">All Priorities</option>
          <option value="urgent">Urgent</option>
          <option value="normal">Normal</option>
        </select>
        <select id="issueFilterType">
            <option value="">All Types</option>
            <option value="technical">Technical</option>
            <option value="behavior">Behavior</option>
            <option value="other">Other</option>
        </select>
        <button class="btn secondary">Filter</button>
      </div>

      <div class="section-content">
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Priority</th>
                    <th>Issue Type</th>
                    <th>Reporter</th>
                    <th>Title</th>
                    <th>Status</th>
                    <th>Assigned To</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="issueTableBody">
                </tbody>
        </table>
        <div id="issuesEmpty" class="empty">No active issues or reports.</div>
      </div>
    </section>

    <section id="ratingsAnalyticsSection" class="hidden">
      <h2>‚≠ê Ratings & Performance Analytics</h2>

      <div class="admin-cards" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
        <div class="admin-card">
          <h4>Overall System Rating (Avg)</h4>
          <div class="metric" id="overallRating">N/A</div>
        </div>
        <div class="admin-card" style="border-left-color: #28a745;">
            <h4>Top Rated Staff Member</h4>
            <div class="metric" id="mostRatedTutor">None</div>
        </div>
        <div class="admin-card" style="border-left-color: #d73a3a;">
            <h4>Lowest Rated Staff Member</h4>
            <div class="metric" id="lowestRatedTutor">None</div>
        </div>
        <div class="admin-card" style="border-left-color: #007bff;">
          <h4>Feedback Volume (Past 30 days)</h4>
          <div class="metric" id="feedbackVolume">0</div>
      </div>
      </div>

      <div class="section-content" style="margin-bottom: 20px;">
        <h3 style="display: flex; justify-content: space-between; align-items: center;">
            Staff Performance Detail: <span id="tutorNameDisplay">Select Staff</span>
            <input id="staffSearch" type="search" placeholder="Search Staff ID/Name..." style="width: 250px; margin: 0;">
        </h3>
        <p><strong>Role:</strong> <span id="staffRole">N/A</span> | <strong>Rating Score:</strong> <span id="tutorRating">N/A</span> | <strong>Sessions Completed:</strong> <span id="tutorSessions">0</span> | <strong>Attendance Rate:</strong> <span id="tutorAttendance">0%</span></p>
        <p><strong>Response Time (Avg):</strong> <span id="tutorResponseTime">N/A</span></p>

        <h4 style="margin-top:20px;">Student Feedback List</h4>
        <div id="tutorFeedbackList" class="muted" style="border: 1px solid #eee; padding: 15px; border-radius: 8px;">
            No feedback available.
        </div>
        <div style="margin-top:15px; display:flex; gap:10px;">
            <button class="btn secondary">View All Feedback</button>
            <button class="btn danger">Send Quality Warning</button>
            <button class="btn">Reward/Boost Visibility</button>
        </div>
      </div>
    </section>

    <section id="universitySettingsSection" class="hidden">
      <h2>‚öôÔ∏è University Settings Management</h2>

      <div class="section-content">
        <h3>Manage Departments (Faculties)</h3>
        <input placeholder="New Department Name (e.g., Science Faculty)">
        <button class="btn" id="addDepartmentBtn">Add Department</button>
        <ul id="departmentList" style="list-style:none; padding-top:10px;">
            <li style="border-bottom: 1px solid #eee; padding: 8px 0; display: flex; justify-content: space-between; align-items: center;">Computer Science <button class="btn secondary btn-sm">Edit</button></li>
            <li style="border-bottom: 1px solid #eee; padding: 8px 0; display: flex; justify-content: space-between; align-items: center;">Mathematics <button class="btn secondary btn-sm">Edit</button></li>
            </ul>
      </div>

      <div class="section-content">
        <h3>Manage Modules (Courses)</h3>
        <select id="moduleDepartmentSelect">
            <option value="">Select Department</option>
            <option value="CS">Computer Science</option>
            </select>
        <input placeholder="New Module Name (e.g., COS 1511)">
        <button class="btn" id="addModuleBtn">Add Module</button>
        <p class="muted" style="margin-top: 10px;" id="moduleList">No modules defined for selected department.</p>
      </div>

      <div class="section-content">
        <h3>System Policy Settings</h3>
        <label>Max Session Duration (Minutes):</label>
        <input type="number" id="maxSessionDuration" value="60">
        <label>Min Tutor Approval Rating:</label>
        <input type="number" step="0.1" id="minTutorRating" value="3.5">
        <button class="btn" id="savePolicySettings">Save Policy Settings</button>
      </div>
    </section>

    <section id="notificationsControlSection" class="hidden">
      <h2>üîî Notifications Control Panel</h2>

      <div class="section-content">
        <h3>Send New Announcement</h3>
        <label>Target Audience:</label>
        <select id="announcementTarget">
            <option value="all">All Users (Students + Staff)</option>
            <option value="students">Only Students</option>
            <option value="staff">Only Tutors/Counsellors</option>
            <option value="dept">Specific Department/Module</option>
        </select>
        <label>Message Title:</label>
        <input id="announcementTitle" placeholder="E.g., System Maintenance Alert">
        <label>Message Content:</label>
        <textarea id="announcementContent" rows="4" placeholder="Enter the full announcement here..."></textarea>
        <label>Type:</label>
        <select id="announcementType">
            <option value="system">System-wide</option>
            <option value="emergency">Emergency Alert</option>
        </select>
        <button class="btn" id="sendNotificationBtn">Send Notification</button>
      </div>

      <div class="section-content">
        <h3>Notification History</h3>
        <p class="muted">Review sent announcements and message logs here.</p>
        </div>
    </section>
    
    <section id="reportsAuditSection" class="hidden">
      <h2>üìú Reports & Audit Logs</h2>

      <div class="section-content">
        <h3>Generate System Reports</h3>
        <label>Report Type:</label>
        <select id="reportType">
            <option value="attendance">Attendance Report</option>
            <option value="booking">Booking Activity Report</option>
            <option value="tutor_performance">Tutor Performance Report</option>
            <option value="student_engagement">Student Engagement Report</option>
            <option value="issue_resolution">Issue Resolution Report</option>
        </select>
        <div style="display:flex; gap:10px;">
          <div style="flex:1;">
            <label>Start Date:</label>
            <input type="date" id="reportStartDate">
          </div>
          <div style="flex:1;">
            <label>End Date:</label>
            <input type="date" id="reportEndDate">
          </div>
        </div>
        <label>Export Format:</label>
        <select id="reportFormat">
            <option value="csv">CSV</option>
            <option value="pdf">PDF</option>
            <option value="excel">Excel</option>
        </select>
        <button class="btn" id="generateReportBtn">Generate & Export Report</button>
      </div>

      <div class="section-content">
        <h3>Audit Log History</h3>
        <input id="auditLogSearch" type="search" placeholder="Search audit log by user, action, or date...">
        <table style="font-size: 13px;">
            <thead>
                <tr>
                    <th>Timestamp</th>
                    <th>User</th>
                    <th>Action</th>
                    <th>Details</th>
                </tr>
            </thead>
            <tbody id="auditLogTableBody">
                </tbody>
        </table>
        <div id="auditLogEmpty" class="empty">No audit history available.</div>
      </div>
    </section>
    
    <section id="adminProfileSection" class="hidden">
      <h2>üë§ Admin Profile & Security</h2>
      
      <div class="section-content">
        <h3>Admin Profile</h3>
        <label>Name:</label>
        <input id="adminName" value="Jane Doe" type="text">
        <label>Title / Role:</label>
        <input id="adminRole" value="System Administrator" type="text">
        <label>Contact Email:</label>
        <input id="adminEmail" value="jane.doe@admin.uj.ac.za" type="email">
        <button class="btn" id="saveAdminProfileBtn">Save Profile</button>
      </div>

      <div class="section-content">
        <h3>Security Settings</h3>
        <label>Change Password:</label>
        <input type="password" id="newPassword" placeholder="New Password">
        <label>Confirm Password:</label>
        <input type="password" id="confirmNewPassword" placeholder="Confirm New Password">
        <button class="btn danger" id="changePasswordBtn" style="margin-bottom:15px;">Change Password</button>

        <p style="margin-bottom:12px;">Two-factor authentication: <span class="tag approved">Enabled</span> <button class="btn secondary btn-sm" id="manage2faBtn">Manage</button></p>
        <button class="btn danger" id="logoutAllDevicesBtn">Log Out All Devices</button>
      </div>
    </section>

  </main>
</div>

<script>
  // Script to update the time
  setInterval(() => {
    document.getElementById("currentTime").textContent = new Date().toLocaleString();
  }, 1000);

  // Script to handle section switching (Basic client-side routing mock-up)
  const sections = document.querySelectorAll('main section');
  const menuItems = document.querySelectorAll('.sidebar-menu li');

  function showSection(id) {
    sections.forEach(sec => {
      sec.classList.add('hidden');
    });
    menuItems.forEach(item => {
      item.classList.remove('active');
    });

    const targetSection = document.getElementById(id);
    const targetMenu = document.getElementById('menu' + id.replace('Section', ''));

    if (targetSection) targetSection.classList.remove('hidden');
    if (targetMenu) targetMenu.classList.add('active');
    
    // In a real application, you would only show the empty state after the database query returns no results.
    // For this mock-up, we ensure the empty states are visible when the section is loaded until Firebase populates them.
    document.getElementById('userEmpty').classList.remove('hidden');
    document.getElementById('sessionEmpty').classList.remove('hidden');
    document.getElementById('requestsEmpty').classList.remove('hidden');
    document.getElementById('issuesEmpty').classList.remove('hidden');
    document.getElementById('auditLogEmpty').classList.remove('hidden');

    // Hide all tables/lists that would be populated by data until data is loaded
    document.getElementById('userTableBody').innerHTML = '';
    document.getElementById('sessionList').innerHTML = '';
    document.getElementById('pendingRequestsList').innerHTML = '';
    document.getElementById('issueTableBody').innerHTML = '';
    document.getElementById('auditLogTableBody').innerHTML = '';
    
    // Placeholder logic for quick actions metric update
    document.querySelector('#quickApproveTutors span').textContent = document.getElementById('pendingApprovals').textContent;
    document.querySelector('#quickViewIssues span').textContent = document.getElementById('issuesToday').textContent;
  }

  menuItems.forEach(item => {
    // Exclude the Log Out item from section switching
    if (item.id !== 'menuLogout') {
        item.addEventListener('click', () => {
          const sectionId = item.id.replace('menu', '').toLowerCase() + 'Section';
          showSection(sectionId);
        });
    } else {
        item.addEventListener('click', () => {
            // Placeholder for Firebase Logout logic
            console.log('Logging out...');
            alert('Logout functionality to be implemented in admin-portal.js using Firebase Auth.');
        });
    }
  });

  // Default to Dashboard on load
  showSection('dashboardSection');
</script>

<script type="module" src="firebase-config.js"></script>
<script type="module" src="admin-portal.js"></script>
</body>
</html>




